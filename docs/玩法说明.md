# 玩法说明（当前版本）

打开方式（体验版服务）：

- 打开浏览器访问：`http://localhost:4173/`
- 如果访问不了：在项目根目录运行 `npm run preview:daemon`（启动），运行 `npm run preview:stop`（停止）

示意图（HUD/世界）：

![World](./screenshots/01-world.png)

---

## 1. 核心目标：体验“农耕闭环”

你可以在地图上完成一套最小循环：

1) 锄地（把草地变成耕地）  
2) 浇水（当天有效）  
3) 播种（多种种子，按季节售卖）  
4) 睡觉/过天（作物成长推进）  
5) 成熟后用“手”收获，产物进入背包  
6) 购买并放置箱子（Chest），把物品存进去（可跨天保存）
7) 采集资源：用斧头/镐子砍木头/挖石头，获得 `wood` / `stone`

---

## 2. 操作方式

### 2.1 移动

- 方向键 或 `W/A/S/D`

### 2.2 工具/模式切换（快捷键）

- `1`：锄头（Hoe）
- `2`：喷壶（Water）
- `3`：种子（使用“当前选中”的种子）
- `4`：手（Hand，用于收获/打开箱子）
- `5`：箱子（Chest，放置箱子）
- `6`：斧头（Axe，用于砍木头资源）
- `7`：镐子（Pickaxe，用于挖石头资源）
- `Q`：循环切换“当前选中”的种子（只会在你背包里有对应种子时才会切到）

当前工具会在 HUD 的 `Mode` 与下方快捷栏高亮显示。

### 2.3 使用工具

- 鼠标左键点击地块：对该地块使用当前工具

示意图（耕地/浇水/成熟作物）：

![Farming](./screenshots/02-farming.png)

交互限制（更接近星露谷的手感）：

- 只能操作玩家**相邻 1 格（上下左右）**范围内的地块
- 选格框颜色提示：
  - 绿色：可操作范围内
  - 黄色：太远（需要走近）
  - 红色：不可用（碰撞/阻挡）

### 2.4 时间与暂停

- 时间会自动流逝（HUD 的 `Time`）
- 暂停方式：
  - 按 `P` 暂停/继续
  - 点击 HUD 的 `Pause/Resume` 按钮

### 2.5 商店（买种子）

打开/关闭：

- 按 `O` 打开/关闭 Shop

说明：

- 商店会按季节售卖不同种子（当前 demo：春=Parsnip/Potato，夏=Blueberry，秋=Cranberry，冬=关闭）
- 春/夏/秋也会售卖 `Chest (200g)`
- 打开商店会自动暂停时间，关闭后恢复
  - 你也可以手动按 `P`/Pause 控制时间

示意图（Shop 面板）：

![Shop](./screenshots/04-shop.png)

### 2.6 箱子（Chest：存放物品）

放置：

- 先在商店购买 `Chest`
- 按 `5` 切到 Chest 模式
- 鼠标左键点击玩家相邻 1 格地块放置（不能放在已有作物/已有箱子的位置）

打开：

- 按 `4` 切到 Hand
- 点击箱子所在格：会提示 “Chest opened (press I to manage items)”

整理物品：

- 按 `I` 打开 Inventory 后，会在背包下面出现一个 **Chest 网格**
- 用“光标物品（Cursor）”在背包/箱子之间转移：
  - 左键：拿起一整叠 / 放下（合并/交换）
  - 右键：拿起半叠 / 放下 1 个

示意图（打开箱子 + Inventory 里出现 Chest 网格）：

![Chest](./screenshots/05-chest.png)

### 2.7 采集资源（wood / stone）

说明：

- 新存档/Reset 后，会在玩家附近自动生成一些“木头/石头”资源（目前是方块占位）

操作：

- 按 `6` 切到 Axe，对着木头格子点一下：会消耗体力与时间；砍完会掉落 `wood`
- 按 `7` 切到 Pickaxe，对着石头格子点一下：会消耗体力与时间；挖完会掉落 `stone`
- 掉落会直接进入背包（可在 Inventory 里看到）

示意图（木头/石头资源与 Axe 模式）：

![Gather](./screenshots/06-gather.png)

### 2.8 睡觉/过天

- 点击 HUD 的 `Sleep`：推进到下一天
  - 会触发作物生长结算
  - 会把浇水状态重置（需要第二天重新浇水）
  - 会自动保存

强制过天：

- 到 `2:00 AM` 会自动“睡倒”并进入下一天

---

## 3. 背包（Inventory）

打开/关闭：

- 按 `I` 打开/关闭背包

示意图（Inventory 面板）：

![Inventory](./screenshots/03-inventory.png)

特性：

- 背包是**固定格子**（目前显示 24 格）
- 打开背包会**自动暂停时间**；关闭背包会恢复时间
- 初始存档会给你一些 `parsnip_seed`（防风草种子）

拖拽/分堆（当前实现）：

- 背包里**左键**格子：
  - 手上没拿东西：拿起整叠
  - 手上拿着东西：放下/合并/交换（视格子内容而定）
- 背包里**右键**格子：
  - 手上没拿东西：拿起半叠
  - 手上拿着东西：每次放下 1 个（如果能放）

出售：

- 背包面板右上角有 `Sell Cursor`：会把你手上拿着的一整叠卖掉并获得金币（Gold）

---

## 4. 常见问题

### 4.1 我点地块没反应

通常是以下原因之一：

- 你点的地块离玩家太远（选格框会变黄）→ 先走到旁边再点
- 你点的是阻挡地块（选格框会变红）
- 体力不足（HUD `Energy` 变成 0）→ 先 `Sleep`
- 没有种子（当前选中的种子数量为 0）→ 按 `Q` 切换到背包里有的种子，或按 `O` 打开 Shop 购买

页面底部会出现短暂提示（toast）说明失败原因。

### 4.2 怎么保存/读取/重开？

在 HUD 上：

- `Save`：手动保存
- `Load`：从本地存档读取
- `Reset`：重置为新存档（会覆盖当前存档）

---

## 5. 建议的上手流程（1 分钟体验）

1) 按 `Reset`（确保有种子）
2) 走到一块空地旁边
3) 按 `1`，点相邻格子（耕地）
4) 按 `2`，点同一格（浇水）
5) 按 `3`，点同一格（播种；如果想换种子按 `Q`）
6) 每天重复一次：`2` 浇水 → `Sleep`
7) 作物成熟后按 `4` 点作物格子收获
8) 按 `I` 看背包里 `parsnip` 数量变化
